<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock LMS portal - Login</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/login.css">
</head>
<body class="login-page">
    <header>
        <nav class="nav-bar">
            <a href="../index.html"><h1>Instituci贸n Educativa ABC</h1></a>
            <a href="login.html" class="btn-login">Iniciar Sesi贸n</a>
        </nav>
    </header>
    
    <section class="login">
        <div class="login-box">
            <h2>隆Bienvenid@!</h2>

            <form id="login-form">
                <div class="input-group">
                    <label>Email:</label>
                    <input type="email" id="login-email" placeholder="ejemplo@correo.com" required>
                </div>

                <div class="input-group">
                    <label>Contrase帽a:</label>
                    <input type="password" id="login-password" placeholder="**********" required>
                </div>

                <p id="login-error" class="hidden">Correo o contrase帽a incorrectos.</p>
                <button class="login-button">Entrar</button>
            </form>
        </div>
    </section>

    <footer>
        <ul>
            <a href="../index.html" class="footernavigation">Inicio</a><p class="gap"> | </p>
            <a href="courses.html" class="footernavigation">Cursos</a><p class="gap"> | </p>
            <a href="#" class="footernavigation">Contacto</a>
        </ul>
        <p>
            漏 2025 Instituci贸n ABC. Todos los derechos reservados. | Hecho con  por: 
            <a href="https://github.com/KarinaMendez17/" target="_blank" class="gthb">Karina M茅ndez.</a>
        </p>
    </footer>

    <script>
        function lsLoad(key) {
            return JSON.parse(localStorage.getItem(key)) || [];
        }
        function lsSave(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        const session = JSON.parse(localStorage.getItem("session"));
        const loginBtn = document.querySelector(".btn-login");

        if (session) {
            loginBtn.textContent = "Cerrar sesi贸n";
            loginBtn.href = "#";
            loginBtn.addEventListener("click", e => {
                e.preventDefault();
                localStorage.removeItem("session");
                window.location.href = "login.html";
            });
        } else {
            loginBtn.textContent = "Iniciar sesi贸n";
            loginBtn.href = "login.html";
        }

        if (session) {
            window.location.href = "admin-panel.html";
        }

        document.getElementById("login-form").addEventListener("submit", e => {
            e.preventDefault();

            const email = document.getElementById("login-email").value.trim();
            const password = document.getElementById("login-password").value.trim();
            const errorMsg = document.getElementById("login-error");
            const admins = lsLoad("admins");

            errorMsg.classList.add("hidden");

            if (!email || !password) {
                return;
            }

            const user = admins.find(a => a.email === email && a.password === password);

            if (user) {
                localStorage.setItem("session", JSON.stringify({
                    id: user.id,
                    name: user.aName,
                    email: user.email,
                    role: "admin",
                    loggedAt: new Date().toISOString()
                }));

                window.location.href = "admin-panel.html";
            } else {
                errorMsg.classList.remove("hidden");
            }
        });
    </script>

</body>
</html>
